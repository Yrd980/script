<div class="title" align=center> <h1>vits-simple-api</h1> <div>Simply call the vits api</div> <br/> <br/> <p> <img src="https://img.shields.io/github/license/Artrajz/vits-simple-api"> <img src="https://img.shields.io/badge/python-3.10-green"> <a href="https://hub.docker.com/r/artrajz/vits-simple-api"> <img src="https://img.shields.io/docker/pulls/artrajz/vits-simple-api"></a> </p> <a href="https://github.com/Artrajz/vits-simple-api/blob/main/README.md">English</a>|<a href="https://github.com/Artrajz/vits-simple-api/blob/main/READMEzh.md">中文文档</a> <br/> </div> Feature - x VITS text-to-speech, voice conversion - x HuBert-soft VITS - x vitschinese - x Bert-VITS2 - x W2V2 VITS / emotional-vits dimensional emotion model - x GPT-SoVITS - x Support for loading multiple models - x Automatic language recognition and processing,set the scope of language type recognition according to model's cleaner,support for custom language type range - x Customize default parameters - x Long text batch processing - x GPU accelerated inference - x SSML Speech Synthesis Markup Language work in progress... Online Demo !Hugging Face Spaceshttps://huggingface.co/spaces/Artrajz/vits-simple-api Thanks to Hugging Face! Colab Notebook Please note that different IDs may support different languages.speakers - - - excited: - whispered: https://user-images.githubusercontent.com/73542220/237995061-c1f25b4e-dd86-438a-9363-4bb1fe65b425.mov Deployment There are two deployment options to choose from. Regardless of the option you select, you'll need to import the model after deployment to use the application. Docker Deployment Recommended for Linux Step 1: Pull the Docker Image Run the following command to pull the Docker image. Follow the prompts in the script to choose the necessary files to download and pull the image: The default paths for project configuration files and model folders are . Step 2: Start Run the following command to start the container: Image Update To update the image, run the following commands: Then, restart the container: Virtual Environment Deployment Step 1: Clone the Project Clone the project repository using the following command: Step 2: Install Python Dependencies It is recommended to use a virtual environment with Python version 3.10 for this project. Run the following command to install the Python dependencies required for the project: If you encounter issues installing certain dependencies, please refer to the common problems outlined below. Step 3: Start Run the following command to start the program: Windows Quick Deployment Package Step 1: Download and Extract the Deployment Package Go to the releases page and download the latest deployment package. Extract the downloaded files. For compression reasons and the Github release limiting the size of a single file to 2GB, there are some optional dependency models that are not included in the deployment package, and these are usually downloaded automatically by the program when loading the corresponding sound model if the loaded model requires it. In case the program doesn't download the dependency model manually, or if you find that If the program does not download the sound model automatically and you need to download the dependency model manually, or if you find that the successfully loaded sound model is empty, please read the Troubleshooting - Successfully loaded model is empty section below. Step 2: Start Run to launch the program. One-Click Cloud Deployment This project image has been deployed on the Compshare. No configuration is required—ready to use out of the box. Register for free and enjoy 5 hours of RTX 4090 or 10 hours of RTX 3080 Ti experience. Click to access Model Loading Step 1: Download VITS Models Download the VITS model files and place them in the folder. Step 2: Loading Models Automatic Model Loading Starting from version 0.6.6, it is default behavior to automatically load all models in the folder, making it easier for beginners to use. If this is your first time and you don't have any additional special needs, you don't need to know how to load the model manually Manual Model Loading After the initial startup, a config.yaml configuration file will be generated. You need to change to in order to enable manual loading mode. You can modify the in the config.yaml or make modifications in the admin panel in the browser. Note: After version 0.6.6, the model loading path has been modified. Please follow the steps below to configure the model path again! The path can be an absolute path or a relative path. If it's a relative path, it starts from the folder in the project root directory. For example, if the folder has the following files: Fill in the configuration like this in the YAML file: Loading models through the admin panel is convenient, but if you want to load models outside the folder, you can only do so by modifying the config.yaml configuration file. The method is to directly provide the absolute path. Absolute path example: - This is the models folder relative to the data directory, with the default value being "models". When autoload is set to true, all models in the directory will be loaded. Other Models After downloading the BERT model and emotion model, place them in the and folders respectively. Find the corresponding names and insert them accordingly. GPU accelerated Windows Install CUDA Check the highest version of CUDA supported by your graphics card: Taking CUDA 11.7 as an example, download it from the official website Install GPU version of PyTorch https://pytorch.org/ Linux The installation process is similar, but I don't have the environment to test it. WebUI Inference Frontend http://127.0.0.1:23456 Port is modifiable under the default setting of port 23456. Admin Backend The default address is http://127.0.0.1:23456/admin. The initial username and password can be found by searching for 'admin' in the config.yaml file after the first startup. Function Options Explanation Disable the Admin Backend The admin backend allows loading and unloading models, and while it has login authentication, for added security, you can disable the admin backend in the : This extra measure helps ensure absolute security when making the admin backend inaccessible to the public network. Bert-VITS2 Configuration and Language/Bert Model Usage Starting from Bert-VITS2 v2.0, a model requires loading three different language Bert models. If you only need to use one or two languages, you can add the parameter in the file of the model's data section. The value indicates that the model only uses Chinese and will load Chinese Bert models. The value indicates the usage of both Chinese and Japanese bilingual models, and only Chinese and Japanese Bert models will be loaded. Similarly, this pattern continues for other language combinations. Example: Custom Chinese Polyphonic Dictionary If you encounter issues with incorrect pronunciation of polyphonic characters, you can try resolving it using the following method. Create and open phrasesdict.txt in the directory to add polyphonic words. GPT-SoVITS Reference Audio Presets Find the configuration for GPT-SoVITS in the config.yaml file. Add presets under the presets section. Multiple presets can be added, with keys serving as preset names. Below are two default presets, default and default2: Reading API Tested in legado Multiple models can be used for reading, including VITS, Bert-VITS2, GPT-SoVITS. Parameters starting with configure the speaker of the text in quotes, while parameters starting with configure the narrator. To use GPT-SoVITS, it is necessary to configure the reference audio in the section of the file in advance and modify the preset in the URL below. The IP in the URL can be found after the API is started, generally using a local area network IP starting with 192.168. After modification, select the reading engine, add the reading engine, paste the source, and enable the reading engine. Frequently Asked Questions Bert-VITS2 Version Compatibility To ensure compatibility with the Bert-VITS2 model, modify the config.json file by adding a version parameter "version": "x.x.x". For instance, if the model version is 1.0.1, the configuration file should be written as: Please note that for the Chinese extra version, the version should be changed to or , and for the extra fix version, the version should be or . Troubleshooting - Successfully loaded models are empty First of all, please check if your program directory is a plain English path can't contain any Chinese or special characters, or else you will encounter the situation that the program can't load models even if it doesn't report an error. Secondly, please check if your models are correctly placed refer to the section of Manual Model Loading. Your models should not be placed directly in , but in a folder under the models directory this folder can be any name without special characters, one directory for each sound model. Lastly, check the log for any messages like download failure, you can refer to the following section on manually placing dependent models Manually placing dependency models download https://hf-mirror.com/TencentGameMate/chinese-hubert-base/resolve/main/pytorchmodel.bin place in 'data\hubert\chinesehubertbase' download https://hf-mirror.com/hfl/chinese-roberta-wwm-ext-large/resolve/main/pytorchmodel.bin place 'data\bert\chinese-roberta-wwm-ext-large' download https://openi.pcl.ac.cn/Stardustminus/Bert-VITS2/modelmanage/modelfilelisttmpl?name=G2PWModel-v2-onnx place 'data\G2PWModel' If you don't want to download it from the openi.pcl.ac.cn platform large files are not available directly from your browser, you can download it here https://huggingface.co/restsun2028/B2ZHTH/blob/b0a8cc2c69c6d1962c679ea2887080a0a86e6bbf/g2pW/g2pW.onnx Get to 'g2pW.onnx' API GET speakers list - GET http://127.0.0.1:23456/voice/speakers Returns the mapping table of role IDs to speaker names. voice vits - GET http://127.0.0.1:23456/voice/vits?text=text Default values are used when other parameters are not specified. - GET http://127.0.0.1:23456/voice/vits?text=ZHtextZHJAtextJA&lang=mix When lang=mix, the text needs to be annotated. - GET http://127.0.0.1:23456/voice/vits?text=text&id=142&format=wav&lang=zh&length=1.4 The text is "text", the role ID is 142, the audio format is wav, the text language is zh, the speech length is 1.4, and the other parameters are default. check - GET http://127.0.0.1:23456/voice/check?id=0&model=vits POST - See API KEY Set in to enable API key authentication. After enabling it, you need to add the parameter in GET requests and add the parameter in the header for POST requests. Parameter VITS | Name | Parameter | Is must | Default | Type | Instruction | | ------------------ | ------------ | ------- | ----------------- | ----- | ------------------------------------------------------------ | | Synthesized text | text | true | | str | Text needed for voice synthesis. | | Speaker ID | id | false | From | int | The speaker ID. | | Audio format | format | false | From | str | Support for wav,ogg,silk,mp3,flac | | Text language | lang | false | From | str | The language of the text to be synthesized. Available options include auto, zh, ja, and mix. When lang=mix, the text should be wrapped in ZH or JA.The default mode is auto, which automatically detects the language of the text | | Audio length | length | false | From | float | Adjusts the length of the synthesized speech, which is equivalent to adjusting the speed of the speech. The larger the value, the slower the speed. | | Noise | noise | false | From | float | Sample noise, controlling the randomness of the synthesis. | | SDP noise | noisew | false | From | float | Stochastic Duration Predictor noise, controlling the length of phoneme pronunciation. | | Segment Size | segmentsize | false | From | int | Divide the text into paragraphs based on punctuation marks, and combine them into one paragraph when the length exceeds segmentsize. If segmentsize<=0, the text will not be divided into paragraphs. | | Streaming response | streaming | false | false | bool | Streamed synthesized speech with faster initial response. | VITS voice conversion | Name | Parameter | Is must | Default | Type | Instruction | | -------------- | ----------- | ------- | ------- | ---- | --------------------------------------------------------- | | Uploaded Audio | upload | true | | file | The audio file to be uploaded. It should be in wav or ogg | | Source Role ID | originalid | true | | int | The ID of the role used to upload the audio file. | | Target Role ID | targetid | true | | int | The ID of the target role to convert the audio to. | HuBert-VITS | Name | Parameter | Is must | Default | Type | Instruction | | ----------------- | --------- | ------- | ------- | ----- | ------------------------------------------------------------ | | Uploaded Audio | upload | true | | file | The audio file to be uploaded. It should be in wav or ogg format. | | Target speaker ID | id | true | | int | The target speaker ID. | | Audio format | format | true | | str | wav,ogg,silk | | Audio length | length | true | | float | Adjusts the length of the synthesized speech, which is equivalent to adjusting the speed of the speech. The larger the value, the slower the speed. | | Noise | noise | true | | float | Sample noise, controlling the randomness of the synthesis. | | sdp noise | noisew | true | | float | Stochastic Duration Predictor noise, controlling the length of phoneme pronunciation. | W2V2-VITS | Name | Parameter | Is must | Default | Type | Instruction | | ------------------- | ------------ | ------- | ----------------- | ----- | ------------------------------------------------------------ | | Synthesized text | text | true | | str | Text needed for voice synthesis. | | Speaker ID | id | false | From | int | The speaker ID. | | Audio format | format | false | From | str | Support for wav,ogg,silk,mp3,flac | | Text language | lang | false | From | str | The language of the text to be synthesized. Available options include auto, zh, ja, and mix. When lang=mix, the text should be wrapped in ZH or JA.The default mode is auto, which automatically detects the language of the text | | Audio length | length | false | From | float | Adjusts the length of the synthesized speech, which is equivalent to adjusting the speed of the speech. The larger the value, the slower the speed. | | Noise | noise | false | From | float | Sample noise, controlling the randomness of the synthesis. | | SDP noise | noisew | false | From | float | Stochastic Duration Predictor noise, controlling the length of phoneme pronunciation. | | Segment Size | segmentsize | false | From | int | Divide the text into paragraphs based on punctuation marks, and combine them into one paragraph when the length exceeds segmentsize. If segmentsize<=0, the text will not be divided into paragraphs. | | Dimensional emotion | emotion | false | 0 | int | The range depends on the emotion reference file in npy format, such as the range of the innnky's model allemotions.npy, which is 0-5457. | Dimensional emotion | Name | Parameter | Is must | Default | Type | Instruction | | -------------- | --------- | ------- | ------- | ---- | ------------------------------------------------------------ | | Uploaded Audio | upload | true | | file | Return the npy file that stores the dimensional emotion vectors. | Bert-VITS2 | Name | Parameter | Is must | Default | Type | Instruction | | ---------------- | --------------- | ------- | ----------------- | ----- | ------------------------------------------------------------ | | Synthesized text | text | true | | str | Text needed for voice synthesis. | | Speaker ID | id | false | From | int | The speaker ID. | | Audio format | format | false | From | str | Support for wav,ogg,silk,mp3,flac | | Text language | lang | false | From | str | "Auto" is a mode for automatic language detection and is also the default mode. However, it currently only supports detecting the language of an entire text passage and cannot distinguish languages on a per-sentence basis. The other available language options are "zh" and "ja". | | Audio length | length | false | From | float | Adjusts the length of the synthesized speech, which is equivalent to adjusting the speed of the speech. The larger the value, the slower the speed. | | Noise | noise | false | From | float | Sample noise, controlling the randomness of the synthesis. | | SDP noise | noisew | false | From | float | Stochastic Duration Predictor noise, controlling the length of phoneme pronunciation. | | Segment Size | segmentsize | false | From | int | Divide the text into paragraphs based on punctuation marks, and combine them into one paragraph when the length exceeds segmentsize. If segmentsize<=0, the text will not be divided into paragraphs. | | SDP/DP mix ratio | sdpratio | false | From | int | The theoretical proportion of SDP during synthesis, the higher the ratio, the larger the variance in synthesized voice tone. | | Emotion | emotion | false | From | int | Available for Bert-VITS2 v2.1, ranging from 0 to 9 | | Emotion reference Audio | referenceaudio | false | None | | Bert-VITS2 v2.1 uses reference audio to control the synthesized audio's emotion | |Text Prompt|textprompt|false|From |str|Bert-VITS2 v2.2 text prompt used for emotion control| |Style Text|styletext|false|From |str|Bert-VITS2 v2.3 text prompt used for emotion control| |Style Text Weight|styleweight|false|From |float|Bert-VITS2 v2.3 text prompt weight used for prompt weighting| | Streaming response | streaming | false | false | bool | Streamed synthesized speech with faster initial response. | GPT-SoVITS Speech Synthesis | Name | Parameter | Is must | Default | Type | Instruction | | ------------ | --------------- | ------- | --------------------- | ----- | ------------------------------------------------------------ | | Synthesized text | text | true | | str | Text needed for voice synthesis. | | Speaker ID | id | false | From | int | Speaker ID. In GPT-SoVITS, each model serves as a Speaker ID, and the voice is switched by reference audio presets. | | Audio format | format | false | From | str | Support for wav, ogg, silk, mp3, flac | | Text language | lang | false | From | str | "auto" is the automatic language detection mode, which is also the default mode. However, it currently only supports recognizing the language of the entire text passage, and cannot distinguish each sentence. | | Reference Audio | referenceaudio | false | None | | referenceaudio is required, but it can be replaced by preset. | | Reference Audio Text | prompttext | false | From | float | Need to be consistent with the actual text of the reference audio. | | Reference Audio Language | promptlang | false | From | str | Defaults to auto for automatic text language recognition. If recognition fails, manually fill in, zh for Chinese, ja for Japanese, en for English. | | Reference Audio Preset | preset | false | default | str | Replace the reference audio with pre-set presets, multiple presets can be set. | SSML Speech Synthesis Markup Language Supported Elements and Attributes Element | Attribute | Instruction | Is must | | ------------ | ------------------------------------------------------------ | ------- | | id | Default value is retrieved From | false | | lang | Default value is retrieved From | false | | length | Default value is retrieved From | false | | noise | Default value is retrieved From | false | | noisew | Default value is retrieved From | false | | segmentsize | Splits text into segments based on punctuation marks. When the sum of segment lengths exceeds , it is treated as one segment. means no segmentation. The default value is 0. | false | | modeltype | Default is VITS. Options: W2V2-VITS, BERT-VITS2 | false | | emotion | Only effective when using W2V2-VITS . The range depends on the npy emotion reference file. | false | | sdpratio | Only effective when using BERT-VITS2 . | false | Element Higher priority than . | Attribute | Instruction | Is must | | ------------ | ------------------------------------------------------------ | ------- | | id | Default value is retrieved From | false | | lang | Default value is retrieved From | false | | length | Default value is retrieved From | false | | noise | Default value is retrieved From | false | | noisew | Default value is retrieved From | false | | segmentsize | Splits text into segments based on punctuation marks. When the sum of segment lengths exceeds , it is treated as one segment. means no segmentation. The default value is 0. | false | | modeltype | Default is VITS. Options: W2V2-VITS, BERT-VITS2 | false | | emotion | Only effective when using W2V2-VITS . The range depends on the npy emotion reference file. | false | | sdpratio | Only effective when using BERT-VITS2 . | false | Element | Attribute | Instruction | Is must | | --------- | ------------------------------------------------------------ | ------- | | strength | x-weak, weak, medium default, strong, x-strong | false | | time | The absolute duration of a pause in seconds such as or milliseconds such as . Valid values range from 0 to 5000 milliseconds. If you set a value greater than the supported maximum, the service will use . If the attribute is set, the attribute is ignored. | false | | Strength | Relative Duration | | :------- | :---------------- | | x-weak | 250 ms | | weak | 500 ms | | medium | 750 ms | | strong | 1000 ms | | x-strong | 1250 ms | Reading | Name | Parameter | Is must | Default | Type | Instruction | | ----------------------------------- | ------------- | ------- | --------------------------- | ---- | ------------------------------------------------------------ | | Synthesis Text | text | true | | str | The text to be synthesized into speech. | | Interlocutor Model Type | inmodeltype | false | Obtained from | str | | | Interlocutor ID | inid | false | Obtained from | int | | | Interlocutor Reference Audio Preset | preset | false | default | str | Replace the reference audio with preset settings, which can be set to multiple presets in advance. | | Narrator Model Type | nrmodeltype | false | Obtained from | str | | | Narrator ID | nrid | false | Obtained from | int | | | Narrator Reference Audio Preset | preset | false | default | str | Replace the reference audio with preset settings, which can be set to multiple presets in advance. | | Audio Format | format | false | Obtained from | str | Supports wav, ogg, silk, mp3, flac | | Text Language | lang | false | Obtained from | str | 'auto' for automatic language detection mode, which is also the default mode. However, currently, it only supports recognizing the language of the entire text and cannot distinguish each sentence. | | Reference Audio Preset | preset | false | default | str | Replace the reference audio with preset settings, which can be set to multiple presets in advance. | The other parameters of the model will use the default parameters of the corresponding model in the config.yaml file. Example See Communication Learning and communication,now there is only Chinese QQ group Acknowledgements - vits:https://github.com/jaywalnut310/vits - MoeGoe:https://github.com/CjangCjengh/MoeGoe - emotional-vits:https://github.com/innnky/emotional-vits - vits-uma-genshin-honkai:https://huggingface.co/spaces/zomehwh/vits-uma-genshin-honkai - vitschinese:https://github.com/PlayVoice/vitschinese - BertVITS2:https://github.com/fishaudio/Bert-VITS2 - GPT-SoVITS:https://github.com/RVC-Boss/GPT-SoVITS Thank You to All Contributors <a href="https://github.com/artrajz/vits-simple-api/graphs/contributors" target="blank"> <img src="https://contrib.rocks/image?repo=artrajz/vits-simple-api"/></a>